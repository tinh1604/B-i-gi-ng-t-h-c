var action={editor:!1,hideForm:function(){return $("#reply-title small a").css("display","none"),$("#content-f").remove(),$("#respond").html(action.getForm()),this.addCkeditor(),!1},addCkeditor:function(){action.editor=CKEDITOR.replace("commentt")},loadcomment:function(){$.ajax({url:config.url+"api/comment/get",method:"POST",data:{post_id:config.id,_token:config.token},success:function(e){action.handleComment(e)}})},handleComment:function(e){if(200==e.status){var t="";if(t='<div class="comments-holder main-box"><h3 class="comment-title main-box-title">Bình Luận</h3><div class="main-box-inside content-inside">',t+='<ul class="comment-list">',""==e.data)t+='<p style="text-align:center;font-weight:bold">Bài viết chưa có bình luận nào. Hãy là người bình luận đầu tiên đi nào!</p>';else for(i in e.data){t+='<li id="comment-'+e.data[i].id+'" class="comment even thread-even depth-1 parent">',t+='<article id="div-comment-24" class="comment-body">',t+='<footer class="comment-meta">',t+='<div class="comment-author vcard">',paths=0!=e.data[i].author_id?config.url+"/api/user/"+e.data[i].author_id+"/image":"https://toidicode.com/upload/images/avatar-toidicode.png",style=0!=e.data[i].author_id?'style="color: red"':"",t+='<img src="'+paths+'" width="75" height="75" alt="" class="avatar avatar-75wp-user-avatar wp-user-avatar-75 alignnone photo avatar-default"><b class="fn"><a href="#" '+style+'rel="external nofollow" class="url">'+e.data[i].name+'</a></b> <span class="says">says:</span></div>',t+='<div class="comment-metadata"><a href="#"><time>'+e.data[i].created_at+"</time></a></div>",t+="</footer>",t+='<div class="comment-content">',t+=e.data[i].content,t+="</div>",t+='<div class="reply"><a rel="nofollow" class="comment-reply-link" href="#" data-parent="'+e.data[i].id+'">Reply</a></div></article>';for(j in e.data)e.data[j].parent==e.data[i].id&&(t+='<ul class="children">',t+='<li id="comment-'+e.data[j].id+'" class="comment even thread-even depth-1 parent">',t+='<article id="div-comment-24" class="comment-body">',t+='<footer class="comment-meta">',t+='<div class="comment-author vcard">',path=0!=e.data[j].author_id?config.url+"/api/user/"+e.data[j].author_id+"/image":"https://toidicode.com/upload/images/avatar-toidicode.png",style=0!=e.data[j].author_id?'style="color: red"':"",t+='<img src="'+path+'" width="75" height="75" alt="" class="avatar avatar-75wp-user-avatar wp-user-avatar-75 alignnone photo avatar-default"><b class="fn"><a href="#comment-'+e.data[i].id+'" '+style+' rel="external nofollow" class="url">'+e.data[j].name+'</a></b> <span class="says">says:</span></div>',t+='<div class="comment-metadata"><a href="#"><time>'+e.data[j].created_at+"</time></a></div>",t+="</footer>",t+='<div class="comment-content">',t+=e.data[j].content,t+="</div>",t+='<div class="reply"><a rel="nofollow" class="comment-reply-link" data-parent="'+e.data[j].parent+'" href="#">Reply</a></div></article>',t+="</ul>",delete e.data[j]);t+="</li>",delete e.data[i]}t+="</ul>\x3c!-- .children --\x3e",t+="</div></div>\x3c!--END comments holder --\x3e",$("#comments").html(t),delete t,action.addevent()}},getForm:function(e=0){var t=!0;if("undefined"!=typeof Storage){null==(a=getStorage())&&(t=!1)}else{t=!1;var a={website:" ",name:" ",email:" "}}var n="";return 1==t?(n='<div id="content-f"><h3 id="reply-title" class="comment-reply-title">Để Lại Bình Luận <small><a rel="nofollow" class="cancel-comment-reply-link" style="display:none;float:right"  onclick="action.hideForm()">X</a></small></h3>',n+='<form action="'+config.url+'comment/addcomment" method="post" id="commentform" autocomplete="off" class="comment-form anti-spam-form-processed">',n+='<p class="comment-form-comment"><label for="comment">Comment <span class="required"> *</span></label><textarea id="commentt" name="comment" cols="45" rows="8" required="true"></textarea></p><p class="comment-form-author"><label for="author">Name<span class="required"> *</span></label> <input id="cname" name="name" type="text" placeholder="Nhập vào tên..." size="30" required="true" value="'+a.name+'"></p>',n+='<p class="comment-form-email"><label for="email">Email<span class="required"> *</span></label> <input id="cemail" name="email" type="text" value="'+a.email+'" size="30" placeholder="Nhập email..." required="true"></p>',n+='<p class="comment-form-url"><label for="url">Website</label><input id="cwebsite" name="url" type="text" value="'+a.website+'" size="30" placeholder="website..."></p>',n+='<p class="comment-captcha"><label for="captcha">Captcha <span class="required"> *</span></label><img src="'+config.url+"/captcha/?key="+Math.random()+'"  alt="captcha" class="captcha-img" onclick="this.setAttribute(\'src\',\''+config.url+"captcha/?key="+Math.random()+'\')" /><input id="ccaptcha" name="captcha" type="text" placeholder="captcha..." required="true"></p>',n+='<p class="form-submit"><input name="submit" type="submit" id="send-comment" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="'+config.id+'" id="cpostid">',n+='<input type="hidden" name="comment_parent" id="cparent" value="'+e+'">',n+='<input type="hidden" name="_token" id="cparent" value="'+config.token+'">',n+="</p>",n+='<input type="hidden" name="type" class="antispam-control antispam-control-a" value="'+config.type+'">',n+="</form></p>",n+="</div>"):(n='<div id="content-f"><h3 id="reply-title" class="comment-reply-title">Để Lại Bình Luận <small><a rel="nofollow" class="cancel-comment-reply-link" style="display:none;float:right"  onclick="action.hideForm()">X</a></small></h3>',n+='<form action="'+config.url+'comment/addcomment" method="post" id="commentform" autocomplete="off" class="comment-form anti-spam-form-processed">',n+='<p class="comment-form-comment"><label for="comment">Comment <span class="required"> *</span></label><textarea id="commentt" name="comment" cols="45" rows="8" required="true"></textarea></p><p class="comment-form-author"><label for="author">Name<span class="required"> *</span></label> <input id="cname" name="name" type="text" placeholder="Nhập vào tên..." size="30" required="true" value=""></p>',n+='<p class="comment-form-email"><label for="email">Email<span class="required"> *</span></label> <input id="cemail" name="email" type="text" value="" size="30" placeholder="Nhập email..." required="true"></p>',n+='<p class="comment-form-url"><label for="url">Website</label><input id="cwebsite" name="url" type="text" value="" size="30" placeholder="website..."></p>',n+='<p class="comment-captcha"><label for="captcha">Captcha <span class="required"> *</span></label><img src="'+config.url+"/captcha/?key="+Math.random()+'"  alt="captcha" class="captcha-img" onclick="this.setAttribute(\'src\',\''+config.url+"captcha/?key="+Math.random()+'\')" /><input id="ccaptcha" name="captcha" type="text" placeholder="captcha..." required="true"></p>',n+='<p class="form-submit"><input name="submit" type="submit" id="send-comment" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="'+config.id+'" id="cpostid">',n+='<input type="hidden" name="comment_parent" id="cparent" value="'+e+'">',n+='<input type="hidden" name="_token" id="cparent" value="'+config.token+'">',n+="</p>",n+='<input type="hidden" name="type" class="antispam-control antispam-control-a" value="'+config.type+'">',n+="</form></p>",n+="</div>"),n},addevent:function(){$(".comment-reply-link").click(function(){return $("#content-f").remove(),$(this).after(action.getForm($(this).attr("data-parent"))),$(".cancel-comment-reply-link").css("display","inline-block"),$("#respond").empty(),action.addCkeditor(),action.addSubmit(),!1})},addComment:function(){var e={name:$("#cname").val(),website:$("#cwebsite").val(),email:$("#cemail").val(),content:CKEDITOR.instances.commentt.getData(),captcha:$("#ccaptcha").val(),post_id:$("#cpostid").val(),parent:$("#cparent").val(),_token:config.token};"undefined"!=typeof Storage&&setStorage(e.name,e.email,e.website),$.ajax({url:config.url+"api/comment/add",method:"post",data:e,success:function(e){500==e.status?toastr.error(e.message):200==e.status&&(toastr.success("Comment của bạn đã được thêm thành công"),$("#comments").empty(),action.loadcomment(),$("#respond").html(action.getForm()),action.addCkeditor(),action.addSubmit())}})},addSubmit:function(){$("#commentform").submit(function(){return action.addComment(),!1})}};if("undefined"!=typeof Storage)var setStorage=function(e,t,a){localStorage.setItem("name",e),localStorage.setItem("email",t),localStorage.setItem("website",a)},getStorage=function(){return null==localStorage.getItem("name")||null==localStorage.getItem("email")||null==localStorage.getItem("website")?null:{name:localStorage.getItem("name"),email:localStorage.getItem("email"),website:localStorage.getItem("website")}};$("#respond").html(action.getForm()),action.addSubmit(),action.loadcomment(),setTimeout(function(){action.addCkeditor()},1e3);var disable=!1;$("#likenews").click(function(){if(0==disable){$(".like-status").css("color","blue"),$(".like-status").text(parseInt($(".like-status").text())+1);var e=$(this).attr("data-id");$.ajax({url:config.url+"api/post/like/",type:"POST",data:{post_id:e,_token:config.token},success:function(e){500==e.status&&toastr.error(e.message)}}),disable=!0}return!1});